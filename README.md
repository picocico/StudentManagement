# 受講生管理システム

## 目的

技術的な講座を受講する人（受講生）の個人情報や何のコースを受けたかを管理したい。

## 要件

- **受講生の個人情報を管理できること**
    - 受講生情報を検索、登録、更新、削除ができること
- **受講生が何のコースを受けたかを管理できること**
    - 受講生のコース情報を検索、登録、更新、削除ができること
- **情報の表示**
    - これらの情報を画面上で確認できること or 画面に連携するためのデータを返せること
- **一括変更**
    - 受講生のコース情報を一括変更できること

## 技術要件

- Javaで開発すること
- SpringBootを使って開発すること
- MySQLを使って開発すること

## 機能

受講生情報（コース含む）を管理する機能

## 仕様

### 受講生情報の定義

- **ID**
- **名前（フルネーム）**
- **ニックネーム**
- **メールアドレス**
- **住んでる地域（市区町村）**
- **年齢**
- **性別（トランスジェンダー考慮)**

### 受講生コース情報の定義

- **ID**
- **受講生情報のID**
- **コース名**
- **受講開始日**
- **受講終了予定日**

## DB設計

### テーブル構成

#### 受講生

受講生の基本情報を保持するテーブル

#### 受講生コース

受講生が受講するコースの情報を保持するテーブル

#### 関連

受講生と受講生コースは1：Nの関係

### ID 設計（UUID 文字列+ BINARY(16)）

各テーブルの主キー（student_id, course_id）には UUID を使用します。

- Web API のインターフェースでは、これらの ID を 標準的な UUID
  文字列表現（例：123e4567-e89b-12d3-a456-426614174000）として扱います。

- 一方、DB およびアプリケーション内部では、UUID を `BINARY(16)` 型／`byte[]` として保持します。
    - MySQL のカラム型は `BINARY(16)` を使用します。
    - エンティティおよび MyBatis Mapper では `byte[]` 型を前提としています。
    - UUID 文字列 ⇔ `BINARY(16)`（`byte[]`）の相互変換は `IdCodec` コンポーネントが担当します。

- この構成により、API 利用者には扱いやすい UUID 文字列インターフェースを提供しつつ、
  DB では UUID のバイナリ表現による省メモリ・インデックス効率のメリットを得ています。

- 今後の拡張として、ユーザ／事務担当が扱いやすい表示用の「studentNumber（生徒番号）」を別途導入し、
  内部ID（UUID）とユーザ向けIDを分離する方針です。

### 日付・日時カラム設計方針

#### 業務上の期間を表す項目

例：student_courses.start_date, student_courses.end_date

- 「コースの開始日・終了日」のように、日単位で管理できれば十分な情報については DATE 型を使用しています。

- これらは「何時何分に開始したか」よりも「何日から何日まで開講しているか」が重要なため、時刻情報は扱いません。

#### レコードの作成日時（監査用途）の項目

例：students.created_at, student_courses.created_at

- レコードが いつ登録されたかを把握するための監査情報として TIMESTAMP 型を使用しています。

- 将来的に「新しい順に並べる」「一定期間内に登録されたデータを集計する」といった要件を想定し、日付だけでなく時刻も保持できるようにしています。

## ErrorResponse（最終仕様）

### JSONスキーマ（概念）

APIはエラー発生時、以下の共通フォーマットでJSONレスポンスを返却します。

**基本形 (E003, E006 など):**
`errors` 配列を含まないシンプルな形式です。

```json
{
  "status": 400,
  "code": "E003",
  "error": "EMPTY_OBJECT",
  "message": "更新対象のフィールドがありません"
}
```

**バリデーションエラー形 (E001 のみ):**
入力値検証に失敗した場合のみ、errors 配列にフィールドごとの詳細が含まれます。

```json
{
  "status": 400,
  "code": "E001",
  "error": "VALIDATION_FAILED",
  "message": "入力値に不備があります",
  "errors": [
    {
      "field": "student.fullName",
      "message": "氏名は必須です"
    },
    {
      "field": "student.email",
      "message": "メールアドレス形式が不正です。"
    }
  ]
}
```

```markdown
- E001: VALIDATION_FAILED
    - 入力値に不備がある場合など

- E003: INVALID_REQUEST (MISSING_PARAMETER / EMPTY_OBJECT など)
    - リクエストボディが無い、必須フィールドやパラメータが欠けている、空オブジェクト など

- E006: INVALID_ID_FORMAT
    - `studentId` などの ID が UUID 形式として不正な場合（`InvalidIdFormatException` に対応）

その他のエラーコードは GlobalExceptionHandler 内の定義を参照
```

**フィールド仕様:**

- status: HTTPステータスコード (数値)

- code: 独自定義のエラーコード (文字列, 例: "E001")

- error: エラー種別 (文字列, 例: "VALIDATION_FAILED")

- message: エラーの詳細メッセージ (文字列)

- errors: (オプション) バリデーションエラーの詳細 (配列)。code が "E001" の場合のみ原則として出力されます。

details (非推奨エイリアス) および errorType, errorCode (旧キー) は一切出力されません。
